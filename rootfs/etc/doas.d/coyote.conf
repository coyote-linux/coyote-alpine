# Coyote Linux doas configuration
#
# Allow the web server user to perform system configuration tasks

# Allow lighttpd to run the privileged apply helper
# This is the primary mechanism for applying system configuration changes
permit nopass lighttpd cmd /opt/coyote/bin/coyote-apply-helper

# Allow lighttpd to remount the config partition (for saving configuration)
permit nopass lighttpd cmd mount args -o remount,rw /mnt/config
permit nopass lighttpd cmd mount args -o remount,ro /mnt/config

# Allow lighttpd to control services
permit nopass lighttpd cmd rc-service
permit nopass lighttpd cmd rc-update

# Allow lighttpd to reboot/shutdown the system
permit nopass lighttpd cmd reboot
permit nopass lighttpd cmd poweroff
